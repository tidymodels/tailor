<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Iterative Steps for Postprocessing Model Predictions • tailor</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Iterative Steps for Postprocessing Model Predictions">
<meta name="description" content="Postprocessors refine predictions outputted from machine learning models to improve predictive performance or better satisfy distributional limitations. This package introduces tailor objects, which compose iterative adjustments to model predictions. A number of pre-written adjustments are provided with the package, like calibration and equivocal zones, as well as utilities to compose new ones. Tailors are tightly integrated with the tidymodels framework.">
<meta property="og:description" content="Postprocessors refine predictions outputted from machine learning models to improve predictive performance or better satisfy distributional limitations. This package introduces tailor objects, which compose iterative adjustments to model predictions. A number of pre-written adjustments are provided with the package, like calibration and equivocal zones, as well as utilities to compose new ones. Tailors are tightly integrated with the tidymodels framework.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">tailor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/tailor/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="tailor">tailor<a class="anchor" aria-label="anchor" href="#tailor"></a>
</h1></div>
<!-- badges: start -->

<p>Postprocessors refine predictions outputted from machine learning models to improve predictive performance or better satisfy distributional limitations. This package introduces ‘tailor’ objects, which compose iterative adjustments to model predictions. In addition to utilities to create new adjustments, the package provides a number of pre-written ones:</p>
<ul>
<li>For probability distributions: calibration</li>
<li>For transformation of probabilities to hard class predictions: thresholds, equivocal zones</li>
<li>For numeric distributions: calibration, range</li>
</ul>
<p>Tailors are tightly integrated with the <a href="https://tidymodels.org" class="external-link">tidymodels</a> framework. For greatest ease of use, situate tailors in model <a href="https://workflows.tidymodels.org" class="external-link">workflows</a> with <code>add_tailor()</code>.</p>
<p>The package is under active development; please treat it as experimental and don’t depend on the syntax staying the same.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of tailor like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"tidymodels/tailor"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/tailor" class="external-link">tailor</a></span><span class="op">)</span></span></code></pre></div>
<p>The <code>two_class_example</code> dataset from modeldata gives the true value of an outcome variable <code>truth</code> as well as predicted probabilities (<code>Class1</code> and <code>Class2</code>). The hard class predictions, in <code>predicted</code>, are <code>"Class1"</code> if the probability assigned to <code>"Class1"</code> is above <code>.5</code>, and <code>"Class2"</code> otherwise.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modeldata.tidymodels.org" class="external-link">modeldata</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'modeldata'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:datasets':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     penguins</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">two_class_example</span><span class="op">)</span></span>
<span><span class="co">#&gt;    truth      Class1       Class2 predicted</span></span>
<span><span class="co">#&gt; 1 Class2 0.003589243 0.9964107574    Class2</span></span>
<span><span class="co">#&gt; 2 Class1 0.678621054 0.3213789460    Class1</span></span>
<span><span class="co">#&gt; 3 Class2 0.110893522 0.8891064779    Class2</span></span>
<span><span class="co">#&gt; 4 Class1 0.735161703 0.2648382969    Class1</span></span>
<span><span class="co">#&gt; 5 Class2 0.016239960 0.9837600397    Class2</span></span>
<span><span class="co">#&gt; 6 Class1 0.999275071 0.0007249286    Class1</span></span></code></pre></div>
<p>The model predicts <code>"Class1"</code> more often than it does <code>"Class2"</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">two_class_example</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">predicted</span><span class="op">)</span></span>
<span><span class="co">#&gt;   predicted   n</span></span>
<span><span class="co">#&gt; 1    Class1 277</span></span>
<span><span class="co">#&gt; 2    Class2 223</span></span></code></pre></div>
<p>If we wanted the model to predict <code>"Class2"</code> more often, we could increase the probability threshold assigned to <code>"Class1"</code> above which the hard class prediction will be <code>"Class1"</code>. In the tailor package, this adjustment is implemented in <code><a href="reference/adjust_probability_threshold.html">adjust_probability_threshold()</a></code>, which can be situated in a tailor object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_obj</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/tailor.html">tailor</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/adjust_probability_threshold.html">adjust_probability_threshold</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span></span>
<span></span>
<span><span class="va">post_obj</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── tailor ──────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; A binary postprocessor with 1 adjustment:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Adjust probability threshold to 0.9.</span></span></code></pre></div>
<p>tailors must be fitted before they can predict on new data. For adjustments like <code><a href="reference/adjust_probability_threshold.html">adjust_probability_threshold()</a></code>, there’s no training that actually happens at the <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code> step besides recording the name and type of relevant variables. For other adjustments, like probability calibration with <code><a href="reference/adjust_probability_calibration.html">adjust_probability_calibration()</a></code>, parameters are actually estimated at the <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code> step and separate data should be used to train the postprocessor and evaluate its performance.</p>
<p>In this case, though, we can <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code> on the whole dataset. The resulting object is still a tailor, but is now flagged as trained.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span></span>
<span>  <span class="va">post_obj</span>,</span>
<span>  <span class="va">two_class_example</span>,</span>
<span>  outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">truth</span><span class="op">)</span>,</span>
<span>  estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">predicted</span><span class="op">)</span>,</span>
<span>  probabilities <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Class1</span>, <span class="va">Class2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">post_res</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── tailor ──────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; A binary postprocessor with 1 adjustment:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Adjust probability threshold to 0.9. [trained]</span></span></code></pre></div>
<p>When used with a model <a href="https://workflows.tidymodels.org" class="external-link">workflow</a> via <code>add_tailor()</code>, the arguments to <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code> a tailor will be set automatically (in addition to the data splitting needed for postprocessors that require training).</p>
<p>Now, when passed new data, the trained tailor will determine the outputted class based on whether the probability assigned to the level <code>"Class1"</code> is above <code>.9</code>, resulting in more predictions of <code>"Class2"</code> than before.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">post_res</span>, <span class="va">two_class_example</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">predicted</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span><span class="co">#&gt;   predicted     n</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;     &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 Class1      180</span></span>
<span><span class="co">#&gt; 2 Class2      320</span></span></code></pre></div>
<p>Tailors compose adjustments; when several <code>adjust_*()</code> functions are called iteratively, tailors will apply them in order at <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code> and <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> time.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tidymodels/tailor/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/tidymodels/tailor/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
<li><a href="SUPPORT.html">Getting help</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tailor</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Simon Couch <br><small class="roles"> Author </small>   </li>
<li>Hannah Frick <br><small class="roles"> Author </small>   </li>
<li>Emil HvitFeldt <br><small class="roles"> Author </small>   </li>
<li>Max Kuhn <br><small class="roles"> Author, maintainer </small>   </li>
<li>Posit Software, PBC <br><small class="roles"> Copyright holder, funder </small>  <a href="https://ror.org/03wc8by49" class="external-link"><img src="https://raw.githubusercontent.com/ror-community/ror-logos/main/ror-icon-rgb.svg" class="ror" alt="ROR"></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://CRAN.R-project.org/package=tailor" class="external-link"><img src="https://www.r-pkg.org/badges/version/tailor" alt="CRAN status"></a></li>
<li><a href="https://github.com/tidymodels/tailor/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/tidymodels/tailor/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/tidymodels/tailor" class="external-link"><img src="https://codecov.io/gh/tidymodels/tailor/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Couch, Hannah Frick, Emil HvitFeldt, Max Kuhn, Posit Software, PBC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
